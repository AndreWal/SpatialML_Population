library(tidyverse)

popdat = read.csv("/home/blablub/Desktop/Dropbox/Projects/Machine_Learning/Own_Projects/Spatial_Predictions/data/raw/NLD/Census.csv")

new = popdat |> arrange(GMDNAME, year) |>mutate(block = cumsum(coalesce(GMDNAME != lag(GMDNAME), FALSE))) |>
  group_by(block, GMDNAME) |>
  fill(GMDNR, .direction = "down") |>
  ungroup() |>
  select(-block) |>
  filter( !is.na(pop) & pop > 0)

unique(new$year)

new = new |> mutate(GMDNR = ifelse(year %in% c(1851, 1860, 1870, 1880, 1890, 1900), 
case_when(GMDNR == 654 ~ 1254,
          GMDNR == 727 ~ 1253,
          GMDNR == 777 ~ 1251,
          GMDNR == 496 ~ 1262,
          GMDNR == 769 ~ 1265,
          GMDNR == 1049 ~ 1263,
          GMDNR == 1111 ~ 1264,
          GMDNR == 1060 ~ 1255,
          GMDNR == 385 ~ 1315,
          GMDNR == 92 ~ 1257,
          GMDNR == 982 ~ 1252,
          GMDNR == 265 ~ 1259,
          GMDNR == 75 ~ 1260,
          GMDNR == 851 ~ 1376,
          .default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(1910, 1920, 1931),
case_when(GMDNR == 654 ~ 1254,
          GMDNR == 727 ~ 1253,
          GMDNR == 777 ~ 1251,
          GMDNR == 385 ~ 1315,
          GMDNR == 92 ~ 1257,
          GMDNR == 982 ~ 1252,
          GMDNR == 265 ~ 1259,
          GMDNR == 75 ~ 1260,
          GMDNR == 851 ~ 1376,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(1940),
case_when(GMDNR == 654 ~ 1254,
          GMDNR == 727 ~ 1253,
          GMDNR == 777 ~ 1251,
          GMDNR == 385 ~ 1315,
          GMDNR == 982 ~ 1252,
          GMDNR == 265 ~ 1259,
          GMDNR == 75 ~ 1260,
          GMDNR == 851 ~ 1376,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(1950),
case_when(GMDNR == 654 ~ 1254,
          GMDNR == 727 ~ 1253,
          GMDNR == 777 ~ 1251,
          GMDNR == 385 ~ 1315,
          GMDNR == 265 ~ 1259,
          GMDNR == 75 ~ 1260,
          GMDNR == 171 ~ 1404,
          GMDNR == 851 ~ 1376,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(1960),
case_when(GMDNR == 654 ~ 1254,
          GMDNR == 727 ~ 1253,
          GMDNR == 777 ~ 1251,
          GMDNR == 385 ~ 1315,
          GMDNR == 171 ~ 1404,
          GMDNR == 851 ~ 1376,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(1971),
case_when(GMDNR == 727 ~ 1253,
          GMDNR == 385 ~ 1315,
          GMDNR == 851 ~ 1376,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(1990),
case_when(GMDNR == 727 ~ 1253,
          GMDNR == 851 ~ 1376,
          GMDNR == 99 ~ 710,
          GMDNR == 94 ~ 737,
          GMDNAME == "Lingewaal" ~ 733,
          GMDNAME == "De Ronde Venen" ~ 736,
          GMDNAME == "Pekela" ~ 765,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(2000),
case_when(GMDNR == 727 ~ 1253,
          GMDNR == 99 ~ 710,
          GMDNR == 94 ~ 737,
          GMDNAME == "Lingewaal" ~ 733,
          GMDNAME == "De Ronde Venen" ~ 736,
          GMDNAME == "Pekela" ~ 765,
           GMDNAME == "Sluis-Aardenburg" ~ 1698,
    GMDNAME == "Noord-Beveland" ~ 1695,
    GMDNAME == "Schouwen-Duiveland" ~ 1676,
    GMDNAME == "Bergeijk" ~ 1724,
    GMDNAME == "Cranendonck" ~ 1706,
    GMDNAME == "Steenbergen" ~ 851,
    GMDNAME == "Roosendaal" ~ 1674,
    GMDNAME == "Halderberge" ~ 1655,
    GMDNAME == "Moerdijk" ~ 1709,
    GMDNAME == "Alphen-Chaam" ~ 1723,
    GMDNAME == "Drimmelen" ~ 1719,
    GMDNAME == "Zevenhuizen-Moerkapelle" ~ 1666,
    GMDNAME == "Reusel-De Mierden" ~ 1667,
    GMDNAME == "Bladel" ~ 1728,
    GMDNAME == "Heeze-Leende" ~ 1658,
    GMDNAME == "Laarbeek" ~ 1659,
    GMDNAME == "Bernheze" ~ 1721,
    GMDNAME == "Maasdonk" ~ 1671,
    GMDNAME == "Rijnwoude" ~ 1672,
    GMDNAME == "Jacobswoude" ~ 645,
    GMDNAME == "Alphen aan den Rijn" ~ 484,
    GMDNAME == "Liemeer" ~ 1673,
    GMDNAME == "Wormerland" ~ 880,
    GMDNAME == "Waterland" ~ 852,
    GMDNAME == "Gulpen-Wittem" ~ 1729,
    GMDNAME == "Heel" ~ 1937,
    GMDNAME == "Roggel en Neer" ~ 1670,
    GMDNAME == "Ambt Montfort" ~ 1679,
    GMDNAME == "Roerdalen" ~ 1669,
    GMDNAME == "Gemert-Bakel" ~ 1652,
    GMDNAME == "Sint Anthonis" ~ 1702,
    GMDNAME == "Landerd" ~ 1685,
    GMDNAME == "Cuijk" ~ 1684,
    GMDNAME == "De Wolden" ~ 1690,
    GMDNAME == "Westerveld" ~ 1701,
    GMDNAME == "FERWERDERADEEL" ~ 1722,
    GMDNAME == "Midden-Drenthe" ~ 1731,
    GMDNAME == "Borger-Odoorn" ~ 1681,
    GMDNAME == "Aa and Hunze" ~ 1680,
    GMDNAME == "Noordenveld" ~ 1699,
    GMDNAME == "Tynaarlo" ~ 1730,
    GMDNAME == "De Marne" ~ 1663,
    GMDNAME == "Menterwolde" ~ 1987,
    GMDNAME == "Reiderland" ~ 1661,
    GMDNAME == "Eemsmond" ~ 1651,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(2010),
case_when(GMDNR == 727 ~ 1253,
          GMDNR == 99 ~ 710,
          GMDNR == 94 ~ 737,
          GMDNAME == "Lingewaal" ~ 733,
          GMDNAME == "De Ronde Venen" ~ 736,
          GMDNAME == "Pekela" ~ 765,
           GMDNAME == "Sluis-Aardenburg" ~ 1698,
    GMDNAME == "Noord-Beveland" ~ 1695,
    GMDNAME == "Schouwen-Duiveland" ~ 1676,
    GMDNAME == "Bergeijk" ~ 1724,
    GMDNAME == "Cranendonck" ~ 1706,
    GMDNAME == "Steenbergen" ~ 851,
    GMDNAME == "Roosendaal" ~ 1674,
    GMDNAME == "Halderberge" ~ 1655,
    GMDNAME == "Moerdijk" ~ 1709,
    GMDNAME == "Alphen-Chaam" ~ 1723,
    GMDNAME == "Drimmelen" ~ 1719,
    GMDNAME == "Zevenhuizen-Moerkapelle" ~ 1666,
    GMDNAME == "Reusel-De Mierden" ~ 1667,
    GMDNAME == "Bladel" ~ 1728,
    GMDNAME == "Heeze-Leende" ~ 1658,
    GMDNAME == "Laarbeek" ~ 1659,
    GMDNAME == "Bernheze" ~ 1721,
    GMDNAME == "Maasdonk" ~ 1671,
    GMDNAME == "Rijnwoude" ~ 1672,
    GMDNAME == "Jacobswoude" ~ 645,
    GMDNAME == "Alphen aan den Rijn" ~ 484,
    GMDNAME == "Liemeer" ~ 1673,
    GMDNAME == "Wormerland" ~ 880,
    GMDNAME == "Waterland" ~ 852,
    GMDNAME == "Gulpen-Wittem" ~ 1729,
    GMDNAME == "Heel" ~ 1937,
    GMDNAME == "Roggel en Neer" ~ 1670,
    GMDNAME == "Ambt Montfort" ~ 1679,
    GMDNAME == "Roerdalen" ~ 1669,
    GMDNAME == "Gemert-Bakel" ~ 1652,
    GMDNAME == "Sint Anthonis" ~ 1702,
    GMDNAME == "Landerd" ~ 1685,
    GMDNAME == "Cuijk" ~ 1684,
    GMDNAME == "De Wolden" ~ 1690,
    GMDNAME == "Westerveld" ~ 1701,
    GMDNAME == "FERWERDERADEEL" ~ 1722,
    GMDNAME == "Midden-Drenthe" ~ 1731,
    GMDNAME == "Borger-Odoorn" ~ 1681,
    GMDNAME == "Aa and Hunze" ~ 1680,
    GMDNAME == "Noordenveld" ~ 1699,
    GMDNAME == "Tynaarlo" ~ 1730,
    GMDNAME == "De Marne" ~ 1663,
    GMDNAME == "Menterwolde" ~ 1987,
    GMDNAME == "Reiderland" ~ 1661,
    GMDNAME == "Eemsmond" ~ 1651,
    GMDNAME == "Sluis" ~ 1714,
GMDNAME == "Westland" ~ 1783,
GMDNAME == "Midden-Delfland" ~ 1842,
GMDNAME == "Pijnacker-Nootdorp" ~ 1926,
GMDNAME == "Lansingerland" ~ 1621,
GMDNAME == "Zuidplas" ~ 1892,
GMDNAME == "Geldrop-Mierlo" ~ 1771,
GMDNAME == "Utrechtse Heuvelrug" ~ 1581,
GMDNAME == "Neder-Betuwe" ~ 1740,
GMDNAME == "Leidschendam-Voorburg" ~ 1916,
GMDNAME == "Teylingen" ~ 1525,
GMDNAME == "Kaag en Braassem" ~ 1884,
GMDNAME == "Wijdemeren" ~ 1696,
GMDNAME == "Koggenland" ~ 1598,
GMDNAME == "Sittard-Geleen" ~ 1883,
GMDNAME == "Echt-Susteren" ~ 1711,
GMDNAME == "Maasgouw" ~ 1641,
GMDNAME == "Leudal" ~ 1640,
GMDNAME == "Peel en Maas" ~ 1894,
GMDNAME == "Horst aan de Maas" ~ 1507,
GMDNAME == "Overbetuwe" ~ 1734,
GMDNAME == "Lingewaard" ~ 1705,
GMDNAME == "Montferland" ~ 1955,
GMDNAME == "Oude IJsselstreek" ~ 1509,
GMDNAME == "Oost Gelre" ~ 1586,
GMDNAME == "Bronckhorst" ~ 1876,
GMDNAME == "Olst-Wijhe" ~ 1773,
GMDNAME == "Zwartewaterland" ~ 1896,
GMDNAME == "Berkelland" ~ 1859,
GMDNAME == "Rijssen-Holten" ~ 1742,
GMDNAME == "Hof van Twente" ~ 1735,
GMDNAME == "Dinkelland" ~ 1774,
GMDNAME == "Twenterand" ~ 1700,
GMDNAME == "Steenwijkerland" ~ 1708,
GMDNAME == "Dantumadiel" ~ 1891,
GMDNAME == "Oldambt" ~ 1895,
.default = GMDNR), 
GMDNR),
GMDNR = ifelse(year %in% c(2020),
case_when(GMDNR == 727 ~ 1253,
          GMDNR == 99 ~ 710,
          GMDNR == 94 ~ 737,
          GMDNAME == "Lingewaal" ~ 733,
          GMDNAME == "De Ronde Venen" ~ 736,
          GMDNAME == "Pekela" ~ 765,
           GMDNAME == "Sluis-Aardenburg" ~ 1698,
    GMDNAME == "Noord-Beveland" ~ 1695,
    GMDNAME == "Schouwen-Duiveland" ~ 1676,
    GMDNAME == "Bergeijk" ~ 1724,
    GMDNAME == "Cranendonck" ~ 1706,
    GMDNAME == "Steenbergen" ~ 851,
    GMDNAME == "Roosendaal" ~ 1674,
    GMDNAME == "Halderberge" ~ 1655,
    GMDNAME == "Moerdijk" ~ 1709,
    GMDNAME == "Alphen-Chaam" ~ 1723,
    GMDNAME == "Drimmelen" ~ 1719,
    GMDNAME == "Zevenhuizen-Moerkapelle" ~ 1666,
    GMDNAME == "Reusel-De Mierden" ~ 1667,
    GMDNAME == "Bladel" ~ 1728,
    GMDNAME == "Heeze-Leende" ~ 1658,
    GMDNAME == "Laarbeek" ~ 1659,
    GMDNAME == "Bernheze" ~ 1721,
    GMDNAME == "Maasdonk" ~ 1671,
    GMDNAME == "Rijnwoude" ~ 1672,
    GMDNAME == "Jacobswoude" ~ 645,
    GMDNAME == "Alphen aan den Rijn" ~ 484,
    GMDNAME == "Liemeer" ~ 1673,
    GMDNAME == "Wormerland" ~ 880,
    GMDNAME == "Waterland" ~ 852,
    GMDNAME == "Gulpen-Wittem" ~ 1729,
    GMDNAME == "Heel" ~ 1937,
    GMDNAME == "Roggel en Neer" ~ 1670,
    GMDNAME == "Ambt Montfort" ~ 1679,
    GMDNAME == "Roerdalen" ~ 1669,
    GMDNAME == "Gemert-Bakel" ~ 1652,
    GMDNAME == "Sint Anthonis" ~ 1702,
    GMDNAME == "Landerd" ~ 1685,
    GMDNAME == "Cuijk" ~ 1684,
    GMDNAME == "De Wolden" ~ 1690,
    GMDNAME == "Westerveld" ~ 1701,
    GMDNAME == "FERWERDERADEEL" ~ 1722,
    GMDNAME == "Midden-Drenthe" ~ 1731,
    GMDNAME == "Borger-Odoorn" ~ 1681,
    GMDNAME == "Aa and Hunze" ~ 1680,
    GMDNAME == "Noordenveld" ~ 1699,
    GMDNAME == "Tynaarlo" ~ 1730,
    GMDNAME == "De Marne" ~ 1663,
    GMDNAME == "Menterwolde" ~ 1987,
    GMDNAME == "Reiderland" ~ 1661,
    GMDNAME == "Eemsmond" ~ 1651,
    GMDNAME == "Sluis" ~ 1714,
GMDNAME == "Westland" ~ 1783,
GMDNAME == "Midden-Delfland" ~ 1842,
GMDNAME == "Pijnacker-Nootdorp" ~ 1926,
GMDNAME == "Lansingerland" ~ 1621,
GMDNAME == "Zuidplas" ~ 1892,
GMDNAME == "Geldrop-Mierlo" ~ 1771,
GMDNAME == "Utrechtse Heuvelrug" ~ 1581,
GMDNAME == "Neder-Betuwe" ~ 1740,
GMDNAME == "Leidschendam-Voorburg" ~ 1916,
GMDNAME == "Teylingen" ~ 1525,
GMDNAME == "Kaag en Braassem" ~ 1884,
GMDNAME == "Wijdemeren" ~ 1696,
GMDNAME == "Koggenland" ~ 1598,
GMDNAME == "Sittard-Geleen" ~ 1883,
GMDNAME == "Echt-Susteren" ~ 1711,
GMDNAME == "Maasgouw" ~ 1641,
GMDNAME == "Leudal" ~ 1640,
GMDNAME == "Peel en Maas" ~ 1894,
GMDNAME == "Horst aan de Maas" ~ 1507,
GMDNAME == "Overbetuwe" ~ 1734,
GMDNAME == "Lingewaard" ~ 1705,
GMDNAME == "Montferland" ~ 1955,
GMDNAME == "Oude IJsselstreek" ~ 1509,
GMDNAME == "Oost Gelre" ~ 1586,
GMDNAME == "Bronckhorst" ~ 1876,
GMDNAME == "Olst-Wijhe" ~ 1773,
GMDNAME == "Zwartewaterland" ~ 1896,
GMDNAME == "Berkelland" ~ 1859,
GMDNAME == "Rijssen-Holten" ~ 1742,
GMDNAME == "Hof van Twente" ~ 1735,
GMDNAME == "Dinkelland" ~ 1774,
GMDNAME == "Twenterand" ~ 1700,
GMDNAME == "Steenwijkerland" ~ 1708,
GMDNAME == "Dantumadiel" ~ 1891,
GMDNAME == "Oldambt" ~ 1895,
GMDNAME == "Goeree-Overflakkee" ~ 1924,
GMDNAME == "Nissewaard" ~ 1930,
GMDNAME == "Hoeksche Waard" ~ 1963,
GMDNAME == "Altena" ~ 1959,
GMDNAME == "Krimpenerwaard" ~ 1931,
GMDNAME == "Molenlanden" ~ 1978,
GMDNAME == "Meierijstad" ~ 1948,
GMDNAME == "Vijfheerenlanden" ~ 1961,
GMDNAME == "West Betuwe" ~ 1960,
GMDNAME == "Alphen aan den Rijn" ~ 484,
GMDNAME == "Bodegraven-Reeuwijk" ~ 1901,
GMDNAME == "Stichtse Vecht" ~ 1904,
GMDNAME == "Gooise Meren" ~ 1942,
GMDNAME == "Hollands Kroon" ~ 1911,
GMDNAME == "Súdwest-Fryslân" ~ 1900,
GMDNAME == "Waadhoeke" ~ 1949,
GMDNAME == "Eijsden-Margraten" ~ 1903,
GMDNAME == "Beekdaelen" ~ 1954,
GMDNAME == "Berg en Dal" ~ 1945,
GMDNAME == "De Fryske Marren" ~ 1940,
GMDNAME == "Noardeast-Fryslân" ~ 1970,
GMDNAME == "Westerkwartier" ~ 1969,
GMDNAME == "Het Hogeland" ~ 1966,
GMDNAME == "Midden-Groningen" ~ 1952,
GMDNAME == "Westerwolde" ~ 1950,
.default = GMDNR), 
GMDNR))

new <- new |> mutate(year = ifelse(year %in% c(1851, 1931, 1971), year - 1, year))  |> filter(year != 1986)

unique(new$year)

write.csv(new, "/home/blablub/Desktop/Dropbox/Projects/Machine_Learning/Own_Projects/Spatial_Predictions/data/raw/NLD/Census_adj.csv")

